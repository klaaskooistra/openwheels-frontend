<div class="card">
  <div class="card-heading">
    <h2 class="card-title">
      {{ 'MY_TRIPS' | translate }}
    </h2>
  </div>

  <div class="card-body">

    <div class="row">
      <div class="col-xs-12">
        <div class="form-group">
          <select class="form-control" ng-options="year for year in years" ng-model="selectedYear"></select>
        </div>
      </div>
    </div>

    <div class="row" ng-if="!bookings.asOwner.total && !bookings.asRenter.total">
      <div class="col-xs-12">
        <h3 ng-if="showLoaderSpinner" class="no-margin"><i class="fa fa-spinner fa-spin fa-fw text-primary"></i></h3>
        <span ng-if="!showLoaderSpinner">{{ 'NO_TRIPS' | translate }}</span>
      </div>
    </div>
  </div>

</div>

<div class="card" ng-if="bookings.asRenter.total > 0">
  <div class="card-heading">
    <h3 class="card-title">
      <a href="" ng-click="showbookings.asRenter = !showbookings.asRenter">
        <i class="fa fa-fw" ng-class="{ 'fa-chevron-right': !showbookings.asRenter, 'fa-chevron-down': showbookings.asRenter }"></i>
        {{ 'TRIPS_BOOKINGS_FOR_RENTER' | translate }}
      </a>
    </h3>
  </div>

  <div uib-collapse="!showbookings.asRenter">
    <div class="card-body">

      <button class="btn" ng-click="prevPage('asRenter')" ng-disabled="curPage.asRenter == 1"> &lt; </button>
      <p class="btn">{{ curPage.asOwner }}</p>
      <button class="btn" ng-click="nextPage('asRenter')" ng-disabled="curPage.asRenter >= lastPage.asRenter"> &gt; </button>

      <table class="table">
        <thead>
          <tr>
            <th>{{ 'DATE' | translate }}</th>
            <th>{{ 'RESOURCE' | translate }}</th>
            <th>{{ 'OWNER' | translate }}</th>
            <th>{{ 'DISTANCE' | translate }}</th>
            <th></th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="booking in bookings.asRenter.result | orderBy : 'beginBooking' : true">
            <td>{{ booking.beginBooking | amDateFormat:'DD-MM-YYYY' }}</td>
            <td>{{ booking.resource.alias}}</td>
            <td>{{ booking.resource.owner | fullname }}</td>
            <td>{{ booking.trip.odoEnd - booking.trip.odoBegin }}</td>
            <td><span booking-approval-icon="booking"></span></td>
            <td class="text-right"><a ui-sref="owm.booking.show({bookingId: booking.id})">Details</a> <a ng-if="provider === 50" target="_blank" ng-href="{{ createTripDetailsLink(booking) }}"><i class="fa fa-fw fa-external-link-square"></i>PDF</a></td>
          </tr>
        </tbody>
      </table>

    </div>
  </div>
</div>
<div class="card" ng-if="bookings.asOwner.total > 0">
  <div class="card-heading">
    <h3 class="card-title">
      <a href="" ng-click="showbookings.asOwner = !showbookings.asOwner">
        <i class="fa fa-fw" ng-class="{ 'fa-chevron-right': !showbookings.asOwner, 'fa-chevron-down': showbookings.asOwner }">
        </i>
        {{ 'TRIPS_BOOKINGS_FOR_OWNER' | translate }}
      </a>
    </h3>
  </div>

  <div uib-collapse="!showbookings.asOwner">
    <div class="card-body">

      <button class="btn" ng-click="prevPage('asOwner')" ng-disabled="curPage.asOwner == 1"> &lt; </button>
      <p class="btn">{{ curPage.asOwner }}</p>
      <button class="btn" ng-click="nextPage('asOwner')" ng-disabled="curPage.asOwner >= lastPage.asOwner"> &gt; </button>

      <table class="table">
        <thead>
          <tr>
            <th>ID</th>
            <th>{{ 'DATE' | translate }}</th>
            <th>{{ 'STATUS' | translate }}</th>
            <th>{{ 'RESOURCE' | translate }}</th>
            <th>{{ 'RENTER' | translate }}</th>
            <th>{{ 'DISTANCE' | translate }}</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr
            ng-class="{danger: ['cancelled', 'owner_cancelled'].indexOf(booking.status) >= 0, warning: booking.status === 'rejected'}"
            ng-repeat="booking in bookings.asOwner.result | orderBy:['booking.beginBooking','booking.beginRequested']"
          >
            <td>{{ booking.id }}</td>
            <td>{{ (booking.beginBooking | amDateFormat:'DD-MM-YYYY') || (booking.beginRequested | amDateFormat:'DD-MM-YYYY') }}</td>
            <td>{{ booking.status | bookingStatus }}</td>
            <td>{{ booking.resource.alias }}</td>
            <td><a ui-sref="member({ personId: booking.person.id })">{{ booking.person | fullname }}</a></td>
            <td class="text-right">
              <span ng-if="['cancelled', 'owner_cancelled', 'rejected'].indexOf(booking.status) < 0">
                {{ booking.trip.odoEnd - booking.trip.odoBegin }}
              </span>
            </td>
            <td class="text-right">
              <a ui-sref="owm.booking.show({bookingId: booking.id})">Details</a>
              <a ng-if="provider === 50" target="_blank" ng-href="{{ createTripDetailsLink(booking) }}"><i class="fa fa-fw fa-external-link-square"></i>PDF</a>
            </td>
          </tr>
        </tbody>
      </table>

    </div>
  </div>
</div>

